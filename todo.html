<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>‚ú® To-Do App mit Kalender & Erinnerungen</title>

<!-- FullCalendar -->
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>

<style>
  /* ---------- GLOBAL STYLES ---------- */
  :root {
    --primary: #5563DE;
    --primary-dark: #3d4cc3;
    --accent: #6dd5ed;
    --urgent: #ff4d4d;
    --bg: #f4f6fb;
    --glass: rgba(255,255,255,0.8);
    --radius: 16px;
    --transition: 0.25s ease;
  }

  body {
    margin: 0;
    font-family: "Inter", "Segoe UI", sans-serif;
    background: linear-gradient(135deg, #74ABE2, #5563DE, #6dd5ed, #2193b0);
    background-size: 400% 400%;
    animation: gradientShift 15s ease infinite;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
    padding: 2rem;
  }

  @keyframes gradientShift {
    0% {background-position: 0% 50%;}
    50% {background-position: 100% 50%;}
    100% {background-position: 0% 50%;}
  }

  .container {
    width: 100%;
    max-width: 1200px;
    background: var(--glass);
    backdrop-filter: blur(12px);
    border-radius: var(--radius);
    box-shadow: 0 10px 35px rgba(0,0,0,0.2);
    overflow: hidden;
  }

  .header {
    background: var(--primary);
    color: white;
    text-align: center;
    padding: 2rem 1rem;
  }

  .header img {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    border: 3px solid white;
    object-fit: cover;
    margin-bottom: 10px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.25);
  }

  h1 { margin: 0; font-size: 1.8rem; }

  .content {
    padding: 2rem;
    display: flex;
    flex-wrap: wrap;
    gap: 2rem;
  }

  button {
    background: var(--primary);
    color: #fff;
    border: none;
    padding: 0.7rem 1rem;
    border-radius: 10px;
    cursor: pointer;
    font-size: 1rem;
    font-weight: 500;
    transition: background var(--transition), transform 0.15s;
  }

  button:hover { background: var(--primary-dark); }
  button:active { transform: scale(0.96); }

  #show-form-btn {
    background: linear-gradient(135deg, var(--primary), var(--accent));
    font-weight: 600;
    border-radius: 50px;
    box-shadow: 0 6px 15px rgba(0,0,0,0.2);
  }

  .input-form {
    display: none;
    flex-direction: column;
    gap: 0.75rem;
    background: rgba(255,255,255,0.95);
    border-radius: var(--radius);
    padding: 1.5rem;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    margin-top: 1rem;
  }

  .input-form input, .input-form select {
    padding: 10px 12px;
    border: 2px solid #ddd;
    border-radius: 8px;
    font-size: 1rem;
    transition: var(--transition);
  }

  .views {
    display: flex;
    gap: 2rem;
    flex: 1;
    flex-wrap: wrap;
  }

  .list-view, .calendar-view {
    flex: 1;
    min-width: 320px;
    background: white;
    border-radius: var(--radius);
    padding: 1.2rem;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
  }

  h3 { margin-top: 0; }

  ul {
    list-style: none;
    padding: 0;
    margin-top: 15px;
  }

  li {
    background: #f9fafc;
    border-radius: 10px;
    padding: 12px 16px;
    margin-bottom: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border: 1px solid #eee;
    transition: all var(--transition);
  }

  li:hover { transform: translateY(-3px); box-shadow: 0 4px 10px rgba(0,0,0,0.08); }

  .status-offen { background: #fff3c4; color: #a67c00; }
  .status-erledigt { background: #caffd4; color: #006633; }
  .status-urgent { background: #ffbaba; color: #a80000; }

  #calendar { margin-top: 1rem; }
  .weekend-day { background-color: #fafafa !important; }

  /* ---------- MODERN TOOLTIP ---------- */
  .fc-tooltip {
    position: absolute;
    background: rgba(255,255,255,0.95);
    backdrop-filter: blur(8px);
    border-radius: 10px;
    padding: 10px 14px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.15);
    font-size: 0.9rem;
    color: #333;
    pointer-events: none;
    opacity: 0;
    transform: translateY(-6px);
    transition: all 0.15s ease;
    z-index: 9999;
  }

  .fc-tooltip.visible {
    opacity: 1;
    transform: translateY(0);
  }

  @media(max-width: 800px) {
    .views { flex-direction: column; }
  }
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <img src="https://image.pngaaa.com/561/898561-middle.png" alt="Logo" />
    <h1>üóìÔ∏è Meine To-Do App</h1>
  </div>

  <div class="content">
    <div style="flex:1 1 100%;">
      <button id="show-form-btn">‚ûï Neue Aufgabe</button>
      <div class="input-form" id="input-form">
        <input type="text" id="todo-input" placeholder="Titel eingeben..." />
        <input type="date" id="todo-date" />
        <div style="display:flex; gap:10px;">
          <input type="time" id="todo-start" />
          <input type="time" id="todo-end" />
        </div>
        <select id="todo-status">
          <option value="offen">Offen</option>
          <option value="erledigt">Erledigt</option>
        </select>
        <label><input type="checkbox" id="todo-urgent" /> Dringlich</label>
        <div style="display:flex; gap:10px;">
          <button id="save-btn">üíæ Speichern</button>
          <button id="cancel-btn" type="button">‚úñÔ∏è Abbrechen</button>
          <button id="delete-btn" type="button" style="display:none; background:var(--urgent);">üóëÔ∏è L√∂schen</button>
        </div>
      </div>
    </div>

    <div class="views">
      <div class="list-view">
        <h3>üìã Listenansicht</h3>
        <ul id="todo-list"></ul>
      </div>

      <div class="calendar-view">
        <h3>üìÜ Kalenderansicht</h3>
        <div id="calendar"></div>
      </div>
    </div>
  </div>
</div>

<script>
const showFormBtn = document.getElementById('show-form-btn');
const form = document.getElementById('input-form');
const saveBtn = document.getElementById('save-btn');
const cancelBtn = document.getElementById('cancel-btn');
const deleteBtn = document.getElementById('delete-btn');
const input = document.getElementById('todo-input');
const dateInput = document.getElementById('todo-date');
const startInput = document.getElementById('todo-start');
const endInput = document.getElementById('todo-end');
const statusInput = document.getElementById('todo-status');
const urgentInput = document.getElementById('todo-urgent');
const todoList = document.getElementById('todo-list');

let todos = JSON.parse(localStorage.getItem('todos')) || [];
let editId = null;

const tooltip = document.createElement('div');
tooltip.classList.add('fc-tooltip');
document.body.appendChild(tooltip);

// Kalender
let calendar = new FullCalendar.Calendar(document.getElementById('calendar'), {
  initialView: 'dayGridMonth',
  locale: 'de',
  height: 500,
  events: [],
  dayCellClassNames: arg => (arg.date.getDay() === 0 || arg.date.getDay() === 6) ? ['weekend-day'] : [],
  eventDidMount: function(info) {
    info.el.addEventListener('mouseenter', e => {
      const { title, start, end, extendedProps } = info.event;
      const startTime = start ? start.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'}) : '';
      const endTime = end ? end.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'}) : '';
      tooltip.innerHTML = `
        <strong>${title}</strong><br>
        üìÖ ${start.toLocaleDateString('de-DE')}<br>
        üïì ${startTime} ${endTime ? '‚Äì ' + endTime : ''}<br>
        ${extendedProps.urgent ? '<span style="color:#ff4d4d;">‚ö†Ô∏è Dringlich</span>' : ''}
      `;
      tooltip.classList.add('visible');
      tooltip.style.top = (e.pageY + 10) + 'px';
      tooltip.style.left = (e.pageX + 10) + 'px';
    });

    info.el.addEventListener('mousemove', e => {
      tooltip.style.top = (e.pageY + 10) + 'px';
      tooltip.style.left = (e.pageX + 10) + 'px';
    });

    info.el.addEventListener('mouseleave', () => {
      tooltip.classList.remove('visible');
    });
  }
});
calendar.render();

// CRUD-Funktionen
showFormBtn.onclick = () => { form.style.display='flex'; showFormBtn.style.display='none'; };
cancelBtn.onclick = resetForm;
saveBtn.onclick = saveTodo;
deleteBtn.onclick = deleteTodo;

function saveTodo() {
  const text = input.value.trim();
  const date = dateInput.value;
  if (!text || !date) return alert("Titel und Datum sind Pflicht!");

  const start = startInput.value;
  const end = endInput.value;
  const status = statusInput.value;
  const urgent = urgentInput.checked;

  if (editId) {
    todos = todos.map(t => t.id === editId ? { id: editId, text, date, start, end, status, urgent } : t);
  } else {
    todos.push({ id: Date.now().toString(), text, date, start, end, status, urgent });
  }
  saveAndRender();
}

function deleteTodo() {
  if (!editId) return;
  todos = todos.filter(t => t.id !== editId);
  saveAndRender();
}

function resetForm() {
  form.style.display='none';
  showFormBtn.style.display='inline-block';
  input.value=''; dateInput.value=''; startInput.value=''; endInput.value='';
  urgentInput.checked=false; statusInput.value='offen'; editId=null;
  deleteBtn.style.display='none';
}

function saveAndRender() {
  localStorage.setItem('todos', JSON.stringify(todos));
  renderTodos();
  resetForm();
}

function renderTodos() {
  todoList.innerHTML=''; calendar.removeAllEvents();
  todos.forEach(t => {
    const li=document.createElement('li');
    li.innerHTML = `
      <div>
        <div><strong>${t.text}</strong></div>
        <small>${t.date} ${t.start||''} ${t.end||''}</small><br>
        <span class="${t.urgent?'status-urgent':t.status==='offen'?'status-offen':'status-erledigt'}">${t.urgent?'Dringlich':t.status}</span>
      </div>
      <button>‚úèÔ∏è</button>`;
    li.querySelector('button').onclick=()=>startEdit(t.id);
    todoList.appendChild(li);

    calendar.addEvent({
      id: t.id,
      title: t.text,
      start: t.date + (t.start ? 'T' + t.start : ''),
      end: t.date + (t.end ? 'T' + t.end : ''),
      color: t.urgent ? '#ff4d4d' : (t.status==='offen'?'#5563DE':'#c1ffd7'),
      extendedProps: { urgent: t.urgent }
    });
  });
}

function startEdit(id) {
  const t=todos.find(x=>x.id===id);
  if (!t) return;
  form.style.display='flex'; showFormBtn.style.display='none';
  input.value=t.text; dateInput.value=t.date; startInput.value=t.start; endInput.value=t.end;
  statusInput.value=t.status; urgentInput.checked=t.urgent;
  editId=t.id; deleteBtn.style.display='inline-block';
}

renderTodos();
</script>
</body>
</html>
