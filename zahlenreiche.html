<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Zahlenreihe</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #eef2f7;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }
    .container {
      background: white;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
      max-width: 500px;
      width: 100%;
    }
    input, button {
      width: 100%;
      padding: 0.8rem;
      margin-top: 1rem;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 8px;
    }
    button {
      background-color: #4caf50;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background-color: #45a046;
    }
    .result {
      margin-top: 1.5rem;
      font-size: 1.1rem;
    }
    .highlight {
      font-weight: bold;
      color: #333;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Zahlenreihen-Erkenner</h2>
    <p>Gib eine Zahlenreihe ein, getrennt mit Komma (z. B. 2,4,6,8):</p>
    <input type="text" id="sequenceInput" placeholder="z. B. 1, 3, 5, 7">
    <button onclick="analyzeSequence()">Muster erkennen</button>
    <div class="result" id="result"></div>
  </div>

  <script>
    function parseInput(input) {
      return input.split(',').map(n => parseFloat(n.trim())).filter(n => !isNaN(n));
    }

    function isArithmetic(seq) {
      const diff = seq[1] - seq[0];
      return seq.every((v, i, arr) => i === 0 || Math.abs(arr[i] - arr[i-1] - diff) < 1e-6)
        ? { type: 'Arithmetisch (+ ' + diff + ')', next: [seq[seq.length-1] + diff, seq[seq.length-1] + 2*diff, seq[seq.length-1] + 3*diff] }
        : null;
    }

    function isGeometric(seq) {
      const ratio = seq[1] / seq[0];
      return seq.every((v, i, arr) => i === 0 || Math.abs(arr[i] / arr[i-1] - ratio) < 1e-6)
        ? { type: 'Geometrisch (× ' + ratio + ')', next: [seq[seq.length-1] * ratio, seq[seq.length-1] * ratio ** 2, seq[seq.length-1] * ratio ** 3] }
        : null;
    }

    function isQuadratic(seq) {
      const diffs = seq.map((v, i, arr) => i === 0 ? 0 : arr[i] - arr[i-1]).slice(1);
      const secondDiffs = diffs.map((v, i, arr) => i === 0 ? 0 : arr[i] - arr[i-1]).slice(1);
      if (secondDiffs.every(d => Math.abs(d - secondDiffs[0]) < 1e-6)) {
        const next = [];
        let last = seq[seq.length-1];
        let d1 = diffs[diffs.length-1];
        let d2 = secondDiffs[0];
        for (let i = 0; i < 3; i++) {
          d1 += d2;
          last += d1;
          next.push(last);
        }
        return { type: 'Quadratisch (+2. Differenz: ' + d2 + ')', next };
      }
      return null;
    }

    function isFibonacci(seq) {
      if (seq.length < 4) return null;
      for (let i = 2; i < seq.length; i++) {
        if (Math.abs(seq[i] - (seq[i - 1] + seq[i - 2])) > 1e-6) return null;
      }
      let next1 = seq[seq.length - 1] + seq[seq.length - 2];
      let next2 = next1 + seq[seq.length - 1];
      let next3 = next2 + next1;
      return { type: 'Fibonacci-Folge', next: [next1, next2, next3] };
    }

    function analyzeSequence() {
      const input = document.getElementById('sequenceInput').value;
      const seq = parseInput(input);
      const resultDiv = document.getElementById('result');

      if (seq.length < 3) {
        resultDiv.innerHTML = 'Bitte gib mindestens 3 gültige Zahlen ein.';
        return;
      }

      const checkers = [isArithmetic, isGeometric, isQuadratic, isFibonacci];
      for (const check of checkers) {
        const res = check(seq);
        if (res) {
          resultDiv.innerHTML = `
            <p><span class="highlight">Erkanntes Muster:</span> ${res.type}</p>
            <p><span class="highlight">Nächste Werte:</span> ${res.next.map(n => n.toFixed(2)).join(', ')}</p>
          `;
          return;
        }
      }

      resultDiv.innerHTML = 'Kein bekanntes Muster erkannt.';
    }
  </script>
</body>
</html>
